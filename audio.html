<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>VocalWings - Audio Classification</title>
    <link rel="icon" type="image/x-icon" href="./favicon.ico" />
    <link
      rel="icon"
      type="image/png"
      sizes="32x32"
      href="./favicon-32x32.png"
    />
    <link rel="apple-touch-icon" href="./apple-touch-icon.png" />
    <link rel="stylesheet" href="./assets/css/audio&learn&tweets.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Roboto:wght@300;400;500;700&family=Oswald:wght@600&display=swap"
      rel="stylesheet"
    />
    <script
      type="module"
      src="https://cdn.jsdelivr.net/npm/ionicons@latest/dist/ionicons/ionicons.esm.js"
    ></script>
    <script
      nomodule
      src="https://cdn.jsdelivr.net/npm/ionicons@latest/dist/ionicons/ionicons.js"
    ></script>
  </head>
  <body>
    <header class="header" data-header>
      <div class="container">
        <h1><a href="#" class="logo">VocalWings</a></h1>
        <button class="nav-open-btn" aria-label="Open Menu" data-nav-open-btn>
          <ion-icon name="menu-outline"></ion-icon>
        </button>
        <nav class="navbar" data-navbar>
          <button
            class="nav-close-btn"
            aria-label="Close Menu"
            data-nav-close-btn
          >
            <ion-icon name="close-outline"></ion-icon>
          </button>
          <a href="#" class="logo">VocalWings</a>
          <ul class="navbar-list">
            <li>
              <a href="index.html#home" class="navbar-link" data-nav-link
                ><span>Home</span></a
              >
            </li>
            <li>
              <a href="index.html#about" class="navbar-link" data-nav-link
                ><span>About</span></a
              >
            </li>
            <li>
              <a href="index.html#service" class="navbar-link" data-nav-link
                ><span>Service</span></a
              >
            </li>
            <li>
              <a href="index.html#species" class="navbar-link" data-nav-link
                ><span>Avian Wonders</span></a
              >
            </li>
            <li>
              <a
                href="tweets.html"
                class="navbar-link"
                data-nav-link
                target="_blank"
                ><span>Tweets</span></a
              >
            </li>
            <li>
              <a href="#footer" class="navbar-link" data-nav-link
                ><span>Contact</span></a
              >
            </li>
          </ul>
        </nav>
        <div class="header-action">
          <button
            class="btn btn-primary"
            onclick="window.open('audio.html', '_blank')"
          >
            <span>Explore</span>
            <ion-icon name="heart-outline" aria-hidden="true"></ion-icon>
          </button>
        </div>
      </div>
    </header>

    <section class="section upload" id="upload">
      <div class="container">
        <div class="upload-banner">
          <h2 class="deco-title">Upload</h2>
          <img
            src="./assets/images/deco-img.png"
            width="58"
            height="261"
            alt=""
            class="deco-img"
          />
          <div class="banner-row">
            <div class="banner-col">
              <img
                src="./assets/images/about-banner-1.jpg"
                width="315"
                height="380"
                loading="lazy"
                alt="Bird Audio Upload"
                class="upload-img w-100"
              />
              <img
                src="./assets/images/about-banner-2.jpg"
                width="386"
                height="250"
                loading="lazy"
                alt="AI Sound Analysis"
                class="upload-img about-img-2 w-100"
              />
            </div>
            <div class="banner-col">
              <img
                src="./assets/images/about-banner-3.jpg"
                width="250"
                height="277"
                loading="lazy"
                alt="Spectrogram Analysis"
                class="upload-img about-img-3 w-100"
              />
              <img
                src="./assets/images/about-banner-4.jpg"
                width="315"
                height="380"
                loading="lazy"
                alt="Bird Species Classification"
                class="upload-img w-100"
              />
            </div>
          </div>
        </div>

        <!-- Audio Upload Section -->
        <div class="upload-content">
          <p class="section-subtitle">
            <img
              src="./assets/images/subtitle-img-green.png"
              width="32"
              height="7"
              alt="Wavy line"
            />
            <span>Let's classify</span>
          </p>
          <h2 class="h2 section-title">Upload Bird Audio</h2>
          <p class="section-text">
            Upload a high-quality audio recording of bird sounds to help our AI
            system analyze and identify bird species. Your contribution supports
            avian research and conservation by improving species recognition and
            monitoring bird populations.
            <br />
            Supported formats: OGG. <br />
            For best results, ensure minimal background noise.
          </p>

          <!-- File Input -->
          <label for="audioFile" class="custom-file-label"
            >Choose Audio File</label
          >
          <input type="file" id="audioFile" accept="audio/ogg" />

          <!-- Error Message -->
          <p id="error" class="error-message"></p>

          <!-- Progress Bar -->
          <div
            id="progressBar"
            class="progress-bar"
            style="width: 0%; background: green; height: 5px"
          ></div>

          <!-- Audio Player -->
          <audio id="audioPlayer" controls style="display: none"></audio>
        </div>
      </div>
    </section>

    <footer class="footer" id="footer">
      <div class="container">
        <div class="footer-content">
          <!-- About Section -->
          <div class="footer-section about-footer">
            <h3>About Us</h3>
            <p>
              We specialize in bioacoustic research, leveraging AI to analyze
              avian sounds and contribute to wildlife conservation.
            </p>
          </div>
          <!-- Quick Links -->
          <div class="footer-section quick-links">
            <h3>Quick Links</h3>
            <ul class="footer-list">
              <li><a href="#" class="footer-link">Home</a></li>
              <li><a href="#service" class="footer-link">Services</a></li>
              <li><a href="#research" class="footer-link">Research</a></li>
              <li><a href="#footer" class="footer-link">Contact</a></li>
            </ul>
          </div>
          <!-- Contact Section -->
          <div class="footer-section contact">
            <h3>Contact Us</h3>
            <div class="contact-info">
              <p>
                <ion-icon name="mail-outline"></ion-icon>
                <a href="mailto:contact@kanu-ch.com">contact@kanu-ch.com</a>
              </p>
              <p>
                <ion-icon name="call-outline"></ion-icon>
                <a href="tel:XXXXXXXXXX">+91 XXXXXXXXXX</a>
              </p>
            </div>
            <p>
              <ion-icon name="location-outline"></ion-icon> Ajay Kumar Garg
              Enginnering College, Ghazibad, Uttar Pradesh
            </p>
          </div>
          <!-- Social Media -->
          <div class="footer-section social">
            <h3>Follow Us</h3>
            <div class="social-icons">
              <a href="#" class="social-link" title="Facebook"
                ><ion-icon name="logo-facebook"></ion-icon
              ></a>
              <a href="#" class="social-link" title="Twitter"
                ><ion-icon name="logo-twitter"></ion-icon
              ></a>
              <a href="#" class="social-link" title="LinkedIn"
                ><ion-icon name="logo-linkedin"></ion-icon
              ></a>
              <a href="#" class="social-link" title="Instagram"
                ><ion-icon name="logo-instagram"></ion-icon
              ></a>
            </div>
          </div>
        </div>
        <div class="footer-bottom">
          <ul class="footer-list">
            <li><a href="#" class="footer-link">Terms of Use</a></li>
            <li><a href="#" class="footer-link">Privacy Policy</a></li>
          </ul>
          <p class="copyright">
            &copy; 2025 <a href="#" class="copyright-link">kanu-CH</a>. All
            Rights Reserved.
          </p>
        </div>
      </div>
    </footer>

    <script src="./assets/js/script.js"></script>

    <script>
      async function sendAudioToBackend(file) {
        const progressBar = document.getElementById("progressBar");

        const formData = new FormData();
        formData.append("file", file);

        try {
          // Visual loading
          progressBar.style.width = "50%";

          const response = await fetch("http://localhost:8000/predict", {
            method: "POST",
            body: formData,
          });

          progressBar.style.width = "100%";

          if (!response.ok) {
            throw new Error("Failed to get prediction");
          }

          const result = await response.json();
          displayPrediction(result);
        } catch (error) {
          console.error("Prediction Error:", error);
          alert("Error during prediction: " + error.message);
          progressBar.style.width = "0%";
        }
      }

      function displayPrediction(result) {
        const container = document.querySelector(".upload-content");

        // Remove existing result
        const existing = document.getElementById("prediction-result");
        if (existing) existing.remove();

        const resultDiv = document.createElement("div");
        resultDiv.id = "prediction-result";
        resultDiv.style.marginTop = "20px";

        const confidencePercent = (result.confidence * 100).toFixed(2);

        resultDiv.innerHTML = `
        <h3>Prediction Result</h3>
        <p><strong>Species:</strong> ${result.species}</p>
        <p><strong>Confidence:</strong> ${confidencePercent}%</p>
      `;
        container.appendChild(resultDiv);
      }

      // Trigger backend call after validation
      document
        .getElementById("audioFile")
        .addEventListener("change", function (event) {
          const file = event.target.files[0];
          if (file && file.type === "audio/ogg") {
            sendAudioToBackend(file);
          } else {
            alert("Please upload a valid .ogg audio file.");
          }
        });
    </script>
  </body>
</html>
